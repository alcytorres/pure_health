<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Step Calendar</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="calendar-container">
  <!--
    # NEW: Add a form to choose month/year.
    Weâ€™ll keep it simple: drop-downs for month and year.
    Submitting the form triggers a GET request with parameters.
  -->
  <form method="GET" class="month-year-form"> <!-- NEW -->
    <label for="year" class="form-label">Year:</label> <!-- NEW -->
    <select name="year" id="year" class="form-select"> <!-- NEW -->
      {% for y in range(2016, 2025) %} <!-- NEW: 2016 to 2024 inclusive -->
      <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
      {% endfor %}
    </select>
    
    <label for="month" class="form-label">Month:</label> <!-- NEW -->
    <select name="month" id="month" class="form-select"> <!-- NEW -->
      {% for m in range(1,13) %} <!-- 1 to 12 -->
      <option value="{{ m }}" {% if m == selected_month %}selected{% endif %}>{{ m }}</option>
      {% endfor %}
    </select>
    
    <button type="submit" class="form-button">Go</button> <!-- NEW -->
  </form>

  <h1 class="title">
    <!--
      # NEW: Dynamically show the chosen year & month name
      We'll do a simple approach: month number + year
      Or we can map month number to month name. For brevity, keep it numeric or do a quick month map.
    -->
    {% set month_names = [
      'January','February','March','April','May','June',
      'July','August','September','October','November','December'
    ] %}
    {{ month_names[selected_month - 1] }} {{ selected_year }}
  </h1>

  <!-- The calendar grid -->
  <div class="calendar-grid">
    {% for day, steps in month_data %}
    <div class="day-cell">
      {% set fraction = steps / goal if steps < goal else 1 %}
      <div class="day-circle">
        {% if steps == 0 %}
        <!-- Empty circle -->
        <svg class="circle-svg" viewBox="0 0 40 40">
          <circle class="circle-bg-empty" cx="20" cy="20" r="18"></circle>
        </svg>
        {% elif steps >= goal %}
        <!-- Full circle -->
        <svg class="circle-svg" viewBox="0 0 40 40">
          <circle class="circle-full" cx="20" cy="20" r="18"></circle>
        </svg>
        {% else %}
        <!-- Partial circle -->
        {% set circumference = 2 * 3.14159 * 18 %}
        {% set offset = circumference * (1 - fraction) %}
        <svg class="circle-svg" viewBox="0 0 40 40">
          <circle class="circle-bg" cx="20" cy="20" r="18"></circle>
          <circle class="circle-progress" cx="20" cy="20" r="18"
            stroke-dasharray="{{ circumference }}"
            stroke-dashoffset="{{ offset }}"
          ></circle>
        </svg>
        {% endif %}
        <div class="day-number">{{ day }}</div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
</body>
</html>
